<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>粗利計算ツール - GitHub 版</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
    <h2>粗利計算ツール</h2>

    <div class="header-row">号机选择与规格</div>
    <div class="input-group">
        <div class="field">
            <label for="A12">号机 (A12)</label>
            <select id="A12" onchange="lookupMachineData(); updateConfigSelector();">
                </select>
        </div>
        <div id="config_selector_group">
            <label for="config_selector">配置选项 (MA-7/8/9)</label>
            <select id="config_selector" onchange="lookupMachineData(true);"></select>
        </div>
        <div class="field">
            <label for="D14">头数 (D14)</label>
            <input type="number" id="D14" class="auto-field" readonly>
        </div>
        <div class="field">
            <label for="M14_power">功率 (M14) / kW</label>
            <input type="number" id="M14_power" class="auto-field" readonly>
        </div>
        <div class="field">
            <label for="E14">线速 (E14) / m/min</label>
            <input type="number" id="E14" value="410">
        </div>
    </div>

    <div class="header-row">产品参数与漆料单价</div>
    <div class="input-group">
        <div class="field">
            <label for="B14">导体径 (B14) / mm</label>
            <input type="number" id="B14" value="0.09" step="0.001">
        </div>
        <div class="field">
            <label for="C14">仕上外径 (C14) / mm</label>
            <input type="number" id="C14" value="0.102" step="0.001">
        </div>
        <div class="field">
            <label for="I7_select">漆种类选择</label>
            <select id="I7_select" onchange="updatePaintPrice()">
                <option value="">-- 选择型号 --</option>
                <optgroup label="TPU系列">
                    <option value="28.88">TPU 6222 LKCF</option>
                    <option value="20.88">TPU 6228LKCF0.5</option>
                    <option value="50.48">TPU K5-132-30F</option>
                </optgroup>
                <optgroup label="APU/Voltatex系列">
                    <option value="37.82">APU-2826NSL</option>
                    <option value="16.33">Voltatex 6325(T)</option>
                </optgroup>
                <option value="0">其他 (手动输入)</option>
            </select>
        </div>
        <div class="field">
            <label for="I8">漆单价 (I8)</label>
            <input type="number" id="I8" class="auto-field" value="13.72">
        </div>
        <div class="field">
            <label for="A14">品种 (A14)</label>
            <input type="text" id="A14" value="UEW">
        </div>
    </div>

    <div class="header-row">其他费用参数</div>
    <div class="input-group">
        <div class="field"><label>电费单价 (S14)</label><input type="number" id="S14" value="0.574"></div>
        <div class="field"><label>加工费 (H12)</label><input type="number" id="H12" value="17.00"></div>
        <div class="field">
            <label>线轴 (K6)</label>
            <select id="K6">
                <option value="PT10" selected>PT10</option>
                <option value="PT15">PT15</option>
            </select>
        </div>
    </div>

    <button id="calculate_button" onclick="calculateMargin()">计算并显示结果</button>

    <div class="header-row result-header">计算结果</div>
    <div class="output-group">
        <div class="field"><label>生产量 (kg)</label><div id="F14" class="res-box">0.00</div></div>
        <div class="field"><label>总成本 (元)</label><div id="O14" class="res-box">0.00</div></div>
        <div class="field important"><label>粗利 (P14)</label><div id="P14" class="res-box highlight-blue">0.00</div></div>
        <div class="field important"><label>含电费粗利 (Q14)</label><div id="Q14" class="res-box highlight-red">0.00</div></div>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>
